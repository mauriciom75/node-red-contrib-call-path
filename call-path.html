<script type="text/javascript">

    RED.nodes.registerType('call-path',{
        category: 'function',
        color: "rgb(51, 153, 102)",
        defaults: {
            name: {value:""},
            flowName: {value:'callPathFlowName', required:true}
        },
        inputs:1,
        outputs:1,
        icon: "node-red-contrib-call-paths.png",
        label: function() {
            return this.name||"call:"+this.flowName;
        }
    });
</script>

<script type="text/x-red" data-template-name="call-path">
    <div class="form-row">
        <label for="node-input-name"><i class="icon-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row">
        <label for="node-input-flowName"><i class="icon-tag"></i> flowName</label>
        <input type="text" id="node-input-flowName" placeholder="flowName">
    </div>
    <div class="form-row node-input-rule-container-row">
        <ol id="node-input-rule-container"></ol>
        
    </div>
</script>

<script type="text/x-red" data-help-name="call-path">
    <p>Call a flow defined by declare-path node. Tries to emulate a call to function, the called flow mut be end by "return-path" node.</p>
    <p>This set of nodes use <b>msg.callPath</b> object to store all necesary working data.</p>
    <p>You can redefine the names of flows to invoke preseting <code>msg.callPath.redefine["flow_Name"] = "implemtation_flow_name"</code></p>
</script>

















<script type="text/javascript">

    RED.nodes.registerType('declare-path',{
        category: 'function',
        color: "rgb(112, 216, 130)",
        defaults: {
            name: {value:""},
            flowName: {value:'callPathFlowName', required:true}
        },
        inputs:0,
        outputs:1,
        icon: "node-red-contrib-call-paths.png",
        label: function() {
            return this.name||"flow:"+this.flowName;
        }

    });
</script>




<script type="text/x-red" data-template-name="declare-path">
    <div class="form-row">
        <label for="node-input-name"><i class="icon-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row">
        <label for="node-input-flowName"><i class="icon-tag"></i> flowName</label>
        <input type="text" id="node-input-flowName" placeholder="flowName">
    </div>
    <div class="form-row node-input-rule-container-row">
        <ol id="node-input-rule-container"></ol>
        
    </div>
</script>

<script type="text/x-red" data-help-name="declare-path">
    <p>Input node that start a calleable callPath flow.</p>
</script>










<script type="text/javascript">

    RED.nodes.registerType('return-path',{
        category: 'function',
        color: "rgb(112, 216, 130)",
        align: 'right',
        defaults: {
            name: {value:""}
        },
        inputs:1,
        outputs:0,
        icon: "node-red-contrib-call-paths.png",
        label: function() {
            return this.name||"return-path";
        }
    });
</script>

<script type="text/x-red" data-template-name="return-path">
    <div class="form-row">
        <label for="node-input-name"><i class="icon-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row node-input-rule-container-row">
        <ol id="node-input-rule-container"></ol>
        
    </div>
</script>

<script type="text/x-red" data-help-name="return-path">
    <p>Output node that ends a callPah flow</p>
    <p>Using the stack under msg.callPath returns to te caller node. If msg.error is defined, then calling node will throw the error.</p>
</script>













<script type="text/javascript">

    RED.nodes.registerType('catch-filter-path',{
        category: 'function',
        color: "rgb(112, 216, 130)",
        defaults: {
            name: {value:""},
            flowName: {value:'callPathFlowName'}
        },
        inputs:1,
        outputs:1,
        icon: "node-red-contrib-call-paths.png",
        label: function() {
            if (this.flowName)
                return this.name||"filter:"+this.flowName;
            else
                return this.name||"filter: all no flow";
        }
    });
</script>

<script type="text/x-red" data-template-name="catch-filter-path">
    <div class="form-row">
        <label for="node-input-name"><i class="icon-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row">
        <label for="node-input-flowName"><i class="icon-tag"></i> flowName</label>
        <input type="text" id="node-input-flowName" placeholder="flowName">
    </div>
    <div class="form-row node-input-rule-container-row">
        <ol id="node-input-rule-container"></ol>
        
    </div>
</script>

<script type="text/x-red" data-help-name="catch-filter-path">
    <p>After a error catch node, this node only send errors throwed by nodes of configured flow.</p>
    <p>Uses "msg.callPath" data to obtain catched msg context flow.</p>
    <p>Enables "catch all" for multiple flows in same tab.</p>
</script>
